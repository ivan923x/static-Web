<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<script src="APP_PKG/report.js" type="text/javascript"></script>
<link href="APP_PKG/report.css" type="text/css" rel="stylesheet">
</head>
<body>
<div class="banner">
<table width="98%"><tr>
<td><h2 class="banner">APP_PKG</h2></td>
</tr></table></div>
<div id="maintabs">
<div class="currentmaintab" onclick="onSelectMainTab(this, 0)">
<div>
<p>Doc</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 1)">
<div>
<p>Details</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 2)">
<div>
<p>Grants</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 3)">
<div>
<p>References</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 4)">
<div>
<p>Dependencies</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 5)">
<div>
<p>Code</p>
</div>
</div>
</div>
<br/>
<div id="masterreports">
<div id="Master.0">
<div class="currentmasterreport">
<TABLE CELLSPACING="0" CELLPADDING="1" WIDTH="100%" BORDER="0">
<TR><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2">      SUMMARY:  <A HREF="#field_summary">FIELD</A> | <A HREF="#type_summary">TYPE</A> | <A HREF="#method_summary">METHOD</A></FONT></TD><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2"></TR></TABLE><HR><P>  <BR>      開發專案:  <a href="https://m1.im.cyut.edu.tw/ords/app111_apex1/r/wm-after-sales-service">木工機械售後服務系統</a> (PLDoc)<br/><BR>      @headcom<BR>    </P><HR><P></P><A NAME="method_summary"></A><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="3" BORDER="1"><TR CLASS="TableHeadingColor"><TD COLSPAN="2"><FONT SIZE="+2"><B>Method Summary</B></FONT></TD><TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#check_auth">check_auth</A></B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_rights_descript IN APP_RIGHTS . DESCRIPT % TYPE ) Return VARCHAR2 ; </CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者功能授權</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否擁有指定使用權限<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為字串類型 'Y'/'N'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_auth(:APP_USER, '申報單檢視');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      </TD></TR>
<TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#check_auth_boolean">check_auth_boolean</A></B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_rights_descript IN APP_RIGHTS . DESCRIPT % TYPE ) Return BOOLEAN ; </CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者功能授權</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否擁有指定使用權限<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為布林類型 True/False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_auth_boolean(:APP_USER, '申報單檢視');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      </TD></TR>
<TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#check_department">check_department</A></B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_department_name IN APP_DEPARTMENT . NAME % TYPE ) Return VARCHAR2 ; </CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者部門</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否為指定部門成員<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為字串類型 'Y'/'N'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_department(:APP_USER, '系統管理');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      </TD></TR>
<TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#check_department_boolean">check_department_boolean</A></B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_department_name IN APP_DEPARTMENT . NAME % TYPE ) Return BOOLEAN ; </CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者部門</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否為指定部門成員<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為布林類型 True/False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_department_boolean(:APP_USER, '系統管理');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      </TD></TR>
<TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#create_sample_data">create_sample_data</A></B></CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>新增範例資料至資料庫</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      (功能測試資料與廠商歷史資料: 109-021 / 109-026 / 109-027 / 109-033 / 109-046 / 110-058 )<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    </TD></TR>
<TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#get_account_application_count">get_account_application_count</A></B>( p_days IN NUMBER : = 7 ) Return VARCHAR2 ; </CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>取得近期的員工帳號申請數</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      以天為單位, 查詢近幾天內新創建, 且尚未啟用之帳號數量<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為數字字串類型<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.get_account_application_count(7); <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      </TD></TR>
<TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#initialize_data">initialize_data</A></B></CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>初始化資料庫</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      將資料庫還原到預設狀態<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      (重置Sequence, 清除並新增部門 / 員工 / 客戶 / 料件 / 權限等預設資料)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    </TD></TR>
</TABLE>
<P></P><A NAME="method_detail"></A><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="3" BORDER="1"><TR CLASS="TableHeadingColor"><TD COLSPAN="2"><FONT SIZE="+2"><B>Method Detail</B></FONT></TD></TABLE><A NAME="check_auth"></A>
<H3>check_auth</H3><PRE>          <B>check_auth</B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_rights_descript IN APP_RIGHTS . DESCRIPT % TYPE ) Return VARCHAR2 ; </PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者功能授權</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否擁有指定使用權限<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為字串類型 'Y'/'N'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_auth(:APP_USER, '申報單檢視');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <DD><DL><DT><B>Parameters:</B><DD><CODE>p_user_email</CODE> - <em>Varchar</em> 使用者帳號 (Google EMail)</DD><DD><CODE>p_rights_descript</CODE> - <em>Varchar</em> 權限名稱 </DD></DT><DT><B>Returns:</B><DD> <em>Varchar</em></DD></DT></DL></DD></DL><HR><A NAME="check_auth_boolean"></A>
<H3>check_auth_boolean</H3><PRE>          <B>check_auth_boolean</B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_rights_descript IN APP_RIGHTS . DESCRIPT % TYPE ) Return BOOLEAN ; </PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者功能授權</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否擁有指定使用權限<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為布林類型 True/False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_auth_boolean(:APP_USER, '申報單檢視');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <DD><DL><DT><B>Parameters:</B><DD><CODE>p_user_email</CODE> - <em>Varchar</em> 使用者帳號 (Google EMail)</DD><DD><CODE>p_rights_descript</CODE> - <em>Varchar</em> 權限名稱</DD></DT><DT><B>Returns:</B><DD> <em>Boolean</em></DD></DT></DL></DD></DL><HR><A NAME="check_department"></A>
<H3>check_department</H3><PRE>          <B>check_department</B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_department_name IN APP_DEPARTMENT . NAME % TYPE ) Return VARCHAR2 ; </PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者部門</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否為指定部門成員<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為字串類型 'Y'/'N'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_department(:APP_USER, '系統管理');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <DD><DL><DT><B>Parameters:</B><DD><CODE>p_user_email</CODE> - <em>Varchar</em> 使用者帳號 (Google EMail)</DD><DD><CODE>p_department_name</CODE> - <em>Varchar</em> 部門名稱</DD></DT><DT><B>Returns:</B><DD> <em>Varchar</em></DD></DT></DL></DD></DL><HR><A NAME="check_department_boolean"></A>
<H3>check_department_boolean</H3><PRE>          <B>check_department_boolean</B>( p_user_email IN APP_EMPLOYEE . EMAIL % TYPE , p_department_name IN APP_DEPARTMENT . NAME % TYPE ) Return BOOLEAN ; </PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>檢查使用者部門</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      使用Email查詢使用者, 是否為指定部門成員<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為布林類型 True/False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.check_department_boolean(:APP_USER, '系統管理');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <DD><DL><DT><B>Parameters:</B><DD><CODE>p_user_email</CODE> - <em>Varchar</em> 使用者帳號 (Google EMail)</DD><DD><CODE>p_department_name</CODE> - <em>Varchar</em> 部門名稱</DD></DT><DT><B>Returns:</B><DD> <em>Boolean</em></DD></DT></DL></DD></DL><HR><A NAME="create_sample_data"></A>
<H3>create_sample_data</H3><PRE>          <B>create_sample_data</B></PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>新增範例資料至資料庫</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      (功能測試資料與廠商歷史資料: 109-021 / 109-026 / 109-027 / 109-033 / 109-046 / 110-058 )<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <DD><DL></DL></DD></DL><HR><A NAME="get_account_application_count"></A>
<H3>get_account_application_count</H3><PRE>          <B>get_account_application_count</B>( p_days IN NUMBER : = 7 ) Return VARCHAR2 ; </PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>取得近期的員工帳號申請數</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      以天為單位, 查詢近幾天內新創建, 且尚未啟用之帳號數量<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      回傳值為數字字串類型<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      @example<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      APP_PKG.get_account_application_count(7); <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <DD><DL><DT><B>Parameters:</B><DD><CODE>p_days</CODE> - <em>Number</em> 近期天數</DD></DT><DT><B>Returns:</B><DD> <em>Varchar</em> 符合條件之帳號數量</DD></DT></DL></DD></DL><HR><A NAME="initialize_data"></A>
<H3>initialize_data</H3><PRE>          <B>initialize_data</B></PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      <strong>初始化資料庫</strong><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      將資料庫還原到預設狀態<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;      (重置Sequence, 清除並新增部門 / 員工 / 客戶 / 料件 / 權限等預設資料)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <DD><DL></DL></DD></DL><HR><TABLE CELLSPACING="0" CELLPADDING="1" WIDTH="100%" BORDER="0">
<TR><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2">      SUMMARY:  <A HREF="#field_summary">FIELD</A> | <A HREF="#type_summary">TYPE</A> | <A HREF="#method_summary">METHOD</A></FONT></TD><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2"></TR></TABLE></div>
</div>
<div id="Master.1">
<div class="masterreport">
<table id="Table.0" cellpadding="0" cellspacing="0" summary="">
<th>NAME</th>
<th>VALUE</th>
</tr>
<tr>
<td>OWNER</td>
<td>APP111_APEX1</td>
</tr>
<tr>
<td>OBJECT_NAME</td>
<td>APP_PKG</td>
</tr>
<tr>
<td>SUBOBJECT_NAME</td>
<td>null</td>
</tr>
<tr>
<td>OBJECT_ID</td>
<td>150905</td>
</tr>
<tr>
<td>DATA_OBJECT_ID</td>
<td>null</td>
</tr>
<tr>
<td>OBJECT_TYPE</td>
<td>PACKAGE</td>
</tr>
<tr>
<td>CREATED</td>
<td>09-7月&nbsp;-23</td>
</tr>
<tr>
<td>LAST_DDL_TIME</td>
<td>05-12月-23</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>2023-12-05:11:40:30</td>
</tr>
<tr>
<td>STATUS</td>
<td>VALID</td>
</tr>
<tr>
<td>TEMPORARY</td>
<td>N</td>
</tr>
<tr>
<td>GENERATED</td>
<td>N</td>
</tr>
<tr>
<td>SECONDARY</td>
<td>N</td>
</tr>
<tr>
<td>NAMESPACE</td>
<td>1</td>
</tr>
<tr>
<td>EDITION_NAME</td>
<td>null</td>
</tr>
<tr>
<td>SHARING</td>
<td>NONE</td>
</tr>
<tr>
<td>EDITIONABLE</td>
<td>Y</td>
</tr>
<tr>
<td>ORACLE_MAINTAINED</td>
<td>N</td>
</tr>
<tr>
<td>APPLICATION</td>
<td>N</td>
</tr>
<tr>
<td>DEFAULT_COLLATION</td>
<td>USING_NLS_COMP</td>
</tr>
<tr>
<td>DUPLICATED</td>
<td>N</td>
</tr>
<tr>
<td>SHARDED</td>
<td>N</td>
</tr>
<tr>
<td>CREATED_APPID</td>
<td>null</td>
</tr>
<tr>
<td>CREATED_VSNID</td>
<td>null</td>
</tr>
<tr>
<td>MODIFIED_APPID</td>
<td>null</td>
</tr>
<tr>
<td>MODIFIED_VSNID</td>
<td>null</td>
</tr>
</table>
</div>
</div>
<div id="Master.2">
<div class="masterreport">
<table id="Table.1" cellpadding="0" cellspacing="0" summary="">
<tr>
<th>PRIVILEGE</th>
<th>GRANTEE</th>
<th>GRANTABLE</th>
<th>GRANTOR</th>
<th>OBJECT_NAME</th>
</tr>
</table>
</div>
</div>
<div id="Master.3">
<div class="masterreport">
<table id="Table.2" cellpadding="0" cellspacing="0" summary="">
<tr>
<th>NAME</th>
<th>OWNER</th>
<th>TYPE</th>
<th>OBJECT_ID</th>
<th>STATUS</th>
<th>TYPE_LINK</th>
</tr>
</table>
</div>
</div>
<div id="Master.4">
<div class="masterreport">
<table id="Table.3" cellpadding="0" cellspacing="0" summary="">
<tr>
<th>NAME</th>
<th>OWNER</th>
<th>TYPE</th>
<th>OBJECT_ID</th>
<th>STATUS</th>
<th>TYPE_LINK</th>
</tr>
</table>
</div>
</div>
<div id="Master.5">
<div class="masterreport">
<pre>
PACKAGE APP_PKG As 
    /** 
    * 開發專案:  &lt;a href="https://m1.im.cyut.edu.tw/ords/app111_apex1/r/wm-after-sales-service">木工機械售後服務系統&lt;/a> (PLDoc)&lt;br/>
    * @headcom
    */

    /**
    * &lt;strong>初始化資料庫&lt;/strong>
    * 將資料庫還原到預設狀態
    * (重置Sequence, 清除並新增部門 / 員工 / 客戶 / 料件 / 權限等預設資料)
    */
    Procedure initialize_data ; 

    /**
    * &lt;strong>新增範例資料至資料庫&lt;/strong>
    * (功能測試資料與廠商歷史資料: 109-021 / 109-026 / 109-027 / 109-033 / 109-046 / 110-058 )
    */
    Procedure create_sample_data ; 

    /**
    * &lt;strong>檢查使用者部門&lt;/strong>
    * 使用Email查詢使用者, 是否為指定部門成員
    * 回傳值為布林類型 True/False
    *
    * @example
    * APP_PKG.check_department_boolean(:APP_USER, '系統管理');
    *
    * @param p_user_email &lt;em>Varchar&lt;/em> 使用者帳號 (Google EMail)
    * @param p_department_name &lt;em>Varchar&lt;/em> 部門名稱
    * @returns &lt;em>Boolean&lt;/em>
    */
    Function check_department_boolean ( 
        p_user_email       IN APP_EMPLOYEE.EMAIL%TYPE, 
        p_department_name  IN APP_DEPARTMENT.NAME%TYPE 
    ) Return BOOLEAN; 

    /**
    * &lt;strong>檢查使用者部門&lt;/strong>
    * 使用Email查詢使用者, 是否為指定部門成員
    * 回傳值為字串類型 'Y'/'N'
    *
    * @example
    * APP_PKG.check_department(:APP_USER, '系統管理');
    *
    * @param p_user_email &lt;em>Varchar&lt;/em> 使用者帳號 (Google EMail)
    * @param p_department_name &lt;em>Varchar&lt;/em> 部門名稱
    * @returns &lt;em>Varchar&lt;/em>
    */
    Function check_department ( 
        p_user_email       IN APP_EMPLOYEE.EMAIL%TYPE, 
        p_department_name  IN APP_DEPARTMENT.NAME%TYPE 
    ) Return VARCHAR2; 

    /**
    * &lt;strong>檢查使用者功能授權&lt;/strong>
    * 使用Email查詢使用者, 是否擁有指定使用權限
    * 回傳值為布林類型 True/False
    *
    * @example
    * APP_PKG.check_auth_boolean(:APP_USER, '申報單檢視');
    *
    * @param p_user_email &lt;em>Varchar&lt;/em> 使用者帳號 (Google EMail)
    * @param p_rights_descript &lt;em>Varchar&lt;/em> 權限名稱
    * @returns &lt;em>Boolean&lt;/em>
    */
    Function check_auth_boolean ( 
        p_user_email       IN APP_EMPLOYEE.EMAIL%TYPE, 
        p_rights_descript  IN APP_RIGHTS.DESCRIPT%TYPE 
    ) Return BOOLEAN; 

    /** 
    * &lt;strong>檢查使用者功能授權&lt;/strong>
    * 使用Email查詢使用者, 是否擁有指定使用權限
    * 回傳值為字串類型 'Y'/'N'
    *
    * @example
    * APP_PKG.check_auth(:APP_USER, '申報單檢視');
    *
    * @param p_user_email &lt;em>Varchar&lt;/em> 使用者帳號 (Google EMail)
    * @param p_rights_descript &lt;em>Varchar&lt;/em> 權限名稱 
    * @returns &lt;em>Varchar&lt;/em>
    */
    Function check_auth ( 
        p_user_email       IN APP_EMPLOYEE.EMAIL%TYPE, 
        p_rights_descript  IN APP_RIGHTS.DESCRIPT%TYPE 
    ) Return VARCHAR2; 

    /** 
    * &lt;strong>取得近期的員工帳號申請數&lt;/strong>
    * 以天為單位, 查詢近幾天內新創建, 且尚未啟用之帳號數量
    * 回傳值為數字字串類型
    *
    * @example
    * APP_PKG.get_account_application_count(7); 
    *
    * @param p_days &lt;em>Number&lt;/em> 近期天數
    * @returns &lt;em>Varchar&lt;/em> 符合條件之帳號數量
    */
    Function get_account_application_count ( 
        p_days  IN NUMBER := 7 
    ) Return VARCHAR2; 

    End APP_PKG;
</pre>
</div>
</div>
</div>
</body>
</html>
